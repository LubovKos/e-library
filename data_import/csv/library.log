2025-05-05 16:37:57,997 [INFO] [__init__:17] Инициализация csvreader
2025-05-05 16:37:57,998 [INFO] [load_from_csv:20] Загрузка CSV: test.csv
2025-05-05 16:37:58,003 [DEBUG] [load_from_csv:32] Заголовки CSV: ['Название книги', 'Автор книги', 'Жанр книги', 'Год выпуска книги', 'Страниц', 'Описание', 'Издательство']
2025-05-05 16:37:58,004 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Преступление и наказание', 'Автор книги': 'Фёдор Достоевский', 'Жанр книги': 'Психологический роман', 'Год выпуска книги': '1866', 'Страниц': '608', 'Описание': 'История бывшего студента Родиона Раскольникова, совершившего убийство и пытающегося найти оправдание своему поступку.', 'Издательство': 'Русский вестник'}
2025-05-05 16:37:58,004 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': '451° по Фаренгейту', 'Автор книги': 'Рэй Брэдбери', 'Жанр книги': 'Антиутопия', 'Год выпуска книги': '1953', 'Страниц': '256', 'Описание': 'Мир будущего, где пожарные сжигают книги, а один из них начинает сомневаться в правильности системы.', 'Издательство': 'Ballantine Books'}
2025-05-05 16:37:58,004 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Гарри Поттер и философский камень', 'Автор книги': 'Джоан Роулинг', 'Жанр книги': 'Фэнтези', 'Год выпуска книги': '1997', 'Страниц': '432', 'Описание': 'Первая книга о приключениях мальчика-волшебника Гарри Поттера в школе Хогвартс.', 'Издательство': 'Bloomsbury'}
2025-05-05 16:37:58,004 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Мастер и Маргарита', 'Автор книги': 'Михаил Булгаков', 'Жанр книги': 'Мистический роман', 'Год выпуска книги': '1967', 'Страниц': '480', 'Описание': 'Фантасмагорическая история о визите дьявола в Москву 1930-х годов и связанных с этим событиях.', 'Издательство': 'YMCA-Press'}
2025-05-05 16:37:58,005 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Краткая история времени', 'Автор книги': 'Стивен Хокинг', 'Жанр книги': 'Научно-популярная', 'Год выпуска книги': '1988', 'Страниц': '256', 'Описание': 'Популярное изложение космологических теорий, включая Большой взрыв и чёрные дыры.', 'Издательство': 'Bantam Books'}
2025-05-05 16:37:58,005 [INFO] [load_from_csv:58] Загружено книг из CSV: 5
2025-05-05 16:38:38,826 [INFO] [__init__:17] Инициализация csvreader
2025-05-05 16:38:38,827 [INFO] [load_from_csv:20] Загрузка CSV: test.csv
2025-05-05 16:38:38,829 [DEBUG] [load_from_csv:32] Заголовки CSV: ['Название книги', 'Автор книги', 'Жанр книги', 'Год выпуска книги', 'Страниц', 'Описание', 'Издательство']
2025-05-05 16:38:38,829 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Преступление и наказание', 'Автор книги': 'Фёдор Достоевский', 'Жанр книги': 'Психологический роман', 'Год выпуска книги': '1866', 'Страниц': '608', 'Описание': 'История бывшего студента Родиона Раскольникова, совершившего убийство и пытающегося найти оправдание своему поступку.', 'Издательство': 'Русский вестник'}
2025-05-05 16:38:38,829 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': '451° по Фаренгейту', 'Автор книги': 'Рэй Брэдбери', 'Жанр книги': 'Антиутопия', 'Год выпуска книги': '1953', 'Страниц': '256', 'Описание': 'Мир будущего, где пожарные сжигают книги, а один из них начинает сомневаться в правильности системы.', 'Издательство': 'Ballantine Books'}
2025-05-05 16:38:38,829 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Гарри Поттер и философский камень', 'Автор книги': 'Джоан Роулинг', 'Жанр книги': 'Фэнтези', 'Год выпуска книги': '1997', 'Страниц': '432', 'Описание': 'Первая книга о приключениях мальчика-волшебника Гарри Поттера в школе Хогвартс.', 'Издательство': 'Bloomsbury'}
2025-05-05 16:38:38,829 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Мастер и Маргарита', 'Автор книги': 'Михаил Булгаков', 'Жанр книги': 'Мистический роман', 'Год выпуска книги': '1967', 'Страниц': '480', 'Описание': 'Фантасмагорическая история о визите дьявола в Москву 1930-х годов и связанных с этим событиях.', 'Издательство': 'YMCA-Press'}
2025-05-05 16:38:38,829 [DEBUG] [load_from_csv:35] Обрабатываем строку: {'Название книги': 'Краткая история времени', 'Автор книги': 'Стивен Хокинг', 'Жанр книги': 'Научно-популярная', 'Год выпуска книги': '1988', 'Страниц': '256', 'Описание': 'Популярное изложение космологических теорий, включая Большой взрыв и чёрные дыры.', 'Издательство': 'Bantam Books'}
2025-05-05 16:38:38,829 [INFO] [load_from_csv:58] Загружено книг из CSV: 5
2025-05-05 16:51:06,740 [INFO] [__init__:16] Инициализация csvreader
2025-05-05 16:51:06,741 [INFO] [load_from_csv:19] Загрузка CSV: test_authors.csv
2025-05-05 16:51:06,745 [ERROR] [load_from_csv:28] Отсутствуют обязательные заголовки: ['Название книги', 'Автор книги', 'Жанр книги', 'Год выпуска книги']
2025-05-05 16:51:06,746 [ERROR] [load_from_csv:48] Ошибка при чтении CSV: CSV не содержит необходимые заголовки
Traceback (most recent call last):
  File "C:\Users\student\PycharmProjects\booksdb\data_import\csv\author_importer.py", line 29, in load_from_csv
    raise ValueError("CSV не содержит необходимые заголовки")
ValueError: CSV не содержит необходимые заголовки
2025-05-05 16:52:16,749 [INFO] [__init__:16] Инициализация csvreader
2025-05-05 16:52:16,749 [INFO] [load_from_csv:19] Загрузка CSV: test_authors.csv
2025-05-05 16:52:16,751 [DEBUG] [load_from_csv:31] Заголовки CSV: ['ФИО', 'Дата рождения', 'Дата смерти', 'Биография']
2025-05-05 16:52:16,751 [DEBUG] [load_from_csv:34] Обрабатываем строку: {'ФИО': 'Фёдор Михайлович Достоевский', 'Дата рождения': '11.11.1821', 'Дата смерти': '09.02.1881', 'Биография': 'Великий русский писатель, мыслитель, философ и публицист. Автор романов «Преступление и наказание», «Идиот», «Братья Карамазовы».'}
2025-05-05 16:52:16,751 [DEBUG] [load_from_csv:34] Обрабатываем строку: {'ФИО': 'Рэй Дуглас Брэдбери', 'Дата рождения': '22.08.1920', 'Дата смерти': '05.06.2012', 'Биография': 'Американский писатель-фантаст, известный по антиутопии «451° по Фаренгейту» и циклу рассказов «Марсианские хроники».'}
2025-05-05 16:52:16,751 [DEBUG] [load_from_csv:34] Обрабатываем строку: {'ФИО': 'Джоан Роулинг', 'Дата рождения': '31.07.1965', 'Дата смерти': '', 'Биография': '', None: ['Британская писательница, автор серии романов о Гарри Поттере. Одна из самых читаемых и коммерчески успешных авторов в мире.']}
2025-05-05 16:52:16,751 [DEBUG] [load_from_csv:34] Обрабатываем строку: {'ФИО': 'Михаил Афанасьевич Булгаков', 'Дата рождения': '15.05.1891', 'Дата смерти': '10.03.1940', 'Биография': 'Советский писатель, драматург, театральный режиссёр. Автор романов «Мастер и Маргарита», «Белая гвардия», пьесы «Дни Турбиных».'}
2025-05-05 16:52:16,751 [DEBUG] [load_from_csv:34] Обрабатываем строку: {'ФИО': 'Стивен Уильям Хокинг', 'Дата рождения': '08.01.1942', 'Дата смерти': '14.03.2018', 'Биография': 'Английский физик-теоретик, космолог, автор научно-популярных книг, включая «Краткую историю времени». Изучал чёрные дыры и теорию Большого взрыва.'}
2025-05-05 16:52:16,751 [INFO] [load_from_csv:45] Загружено книг из CSV: 5
